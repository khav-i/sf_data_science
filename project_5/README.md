# Прогнозирование продолжительности поездки на такси

Данная работа основана на реальном [DataScience-соревновании из Kaggle](https://www.kaggle.com/competitions/nyc-taxi-trip-duration/overview/evaluation).
Мы построим модели, которые будут предсказывать общую продолжительность поездок такси в Нью-Йорке.

## Данные

Помимо основных данных о поездках, предоставляемых организаторами соревнования, мы также будем использовать сторонние ресурсы:
данные о выходных днях за актуальный период времени (первая половина 2016 года), данные из OSRM API, а также сведения о
погодных условиях.

## Метрика

Мы будем следовать канонам исходного соревнования на Kaggle и в качестве метрики использовать RMSLE (Root Mean Squared Log Error),
которая вычисляется как:

![image](https://github.com/khav-i/sf_data_science/assets/126453765/55c52907-56fe-4abe-b48c-f0fbb9669de8)

## Содержание
1. Постановка задачи
2. Знакомство с данными, базовый анализ и расширение данных
3. Разведывательный анализ данных (EDA)
4. Отбор и преобразование признаков
5. Решение задачи регрессии: линейная регрессия и деревья решений
    1. Линейная регрессия
    2. Полиномиальная регрессия
    3. $L_2$ регуляризация
    4. Дерево решений
6. Решение задачи регрессии: ансамблевые методы и построение прогноза
    1. Случайный лес
    2. Градиентный бустинг
    3. Расчет и интерпретация метрики MAE
    4. Загрузка и преобразование тестовых данных
    5. XGBoost
    6. CatBoost
7. Итог

## Результат
Получившиеся значения метрики представлены в виде общей свобной таблицы:
![image](https://github.com/khav-i/sf_data_science/assets/126453765/563d8bc6-251e-43a2-b3b3-b6a34bf9e2e2)

Значения метрики для лучшего сабмита на платформе Kaggle:
![image](https://github.com/khav-i/sf_data_science/assets/126453765/ac94182e-87e6-4535-b9c8-11c247379355)

Как видим, метрика оказалась заметно хуже, чем в прогоне валидационной выборки - это свидетельствует о наличии переобучения
модели. Виной тому, вполне возможно, удаление из треннировочной выборки аномально долгих поездок (длительностью более 24 часов).
Однако при сохранении этих данных значения метрик сабмита на платформе ухудшаются сильнее (RMSLE растет), хоть и разность
падает.

В данной работе в целях экономии времени мы также практически не использовали изощренные способы оптимизации гиперпараметров - 
такие инструменты как optuna, вполне вероятно, позволили бы добиться лучших результатов. Однако в работах участников соревнования
можно встретить даже восьмичасовые прогоны оптимизаций моделей - и все для того, чтобы уменьшить среднюю ошибку предсказания
на секунду. Полагаю, не всегда подобные усложнения стоят того, чтобы тратить на них время (за исключением тех случаев, когда времени 
предостаточно). 

## Непосрдественно с ноутбуком прошу ознакомиться [здесь](https://github.com/khav-i/sf_data_science/blob/main/project_5/predicting_the_duration_of_a_taxi_trip.ipynb)
